<!DOCTYPE html>
<html>
<head>
<script src="https://unpkg.com/konva@8.3.2/konva.min.js"></script>
<script src="grid.js"></script>
<title>Konva Program</title>
</head>
<body>
<div id="konvaCanvas"></div>
<script>
	'use strict'

    let stage = new Konva.Stage({
        container: 'konvaCanvas',
        width: window.innerWidth,
        height: window.innerHeight
    });
    let layer = new Konva.Layer();
	stage.add(layer); 


let episode = {
        Spongebob: {
            name: "Spongebob",
            nets: 10,
            x: 500,
            y: 325,
        },
        Patrick: {
            name: "Patrick",
            jellyfish: 20,
            x: 850,
            y: 325,
        }
    
}

    // // ---- The rendering begins here ----- //

    // addGrid(Konva, layer);

// background

    let fields = new Konva.Layer();
    stage.add(fields)

    let jellyFishFieldsObj = new Image();
    jellyFishFieldsObj.onload = function () {
        let background = new Konva.Image({
            x: 0,
            y: 0,
            image: jellyFishFieldsObj,
        });
        fields.add(background);
    };
    jellyFishFieldsObj.src = 'jellyfishfields.png';

// Spongebob

let bob = new Konva.Layer();
    stage.add(bob)

let groupBob = new Konva.Group({
    draggable: true
});

bob.add(groupBob)

    let SpongebobObj = new Image();
    SpongebobObj.onload = function () {
        let Spongebob = new Konva.Image({
            x: episode.Spongebob.x,
            y: episode.Spongebob.y,
            image: SpongebobObj,
        });
        groupBob.add(Spongebob);
    };
    SpongebobObj.src = 'spongebob.png';

        // Spongebob Text


let spongebobText = new Konva.Label({
        x: episode.Spongebob.x +200,
        y: episode.Spongebob.y +50,
        opacity: 0.75,
      });

      spongebobText.add(
        new Konva.Tag({
          fill: 'black',
          pointerDirection: 'down',
          pointerWidth: 10,
          pointerHeight: 10,
          lineJoin: 'round',
          shadowColor: 'black',
          shadowBlur: 10,
          shadowOffsetX: 10,
          shadowOffsetY: 10,
          shadowOpacity: 0.5,
        })
      );

      spongebobText.add(
        new Konva.Text({
          text: 'Spongebob Squarepants',
          fontFamily: 'Calibri',
          fontSize: 18,
          padding: 5,
          fill: 'white',
        })
      );

      groupBob.add(spongebobText)

         // Spongebob Nets

let groupNets = new Konva.Group();
bob.add(groupNets)

let bobNetsObj = new Image();
bobNetsObj.onload = function () {

        for (let i = 0; i < episode.Spongebob.nets; i++) {

          let bobNets = new Konva.Image({
               x: 10 + i*65,
               y: 700,
               image: bobNetsObj,
          });
          groupNets.add(bobNets);
     }
};

bobNetsObj.src = 'net.png';


// Patrick

let pat = new Konva.Layer();
    stage.add(pat)

let groupPat = new Konva.Group({
    draggable: true
});

pat.add(groupPat)

    let PatrickObj = new Image();
    PatrickObj.onload = function () {
        let Patrick = new Konva.Image({
            x: episode.Patrick.x,
            y: episode.Patrick.y,
            image: PatrickObj,
        });
        groupPat.add(Patrick);
    };
    PatrickObj.src = 'patrick.png';

      // Patrick Text

let patrickText = new Konva.Label({
        x: episode.Patrick.x +200,
        y: episode.Patrick.y +400,
        opacity: 0.75,
      });

      patrickText.add(
        new Konva.Tag({
          fill: 'black',
          pointerDirection: 'up',
          pointerWidth: 10,
          pointerHeight: 10,
          lineJoin: 'round',
          shadowColor: 'black',
          shadowBlur: 10,
          shadowOffsetX: 10,
          shadowOffsetY: 10,
          shadowOpacity: 0.5,
        })
      );

      patrickText.add(
        new Konva.Text({
          text: 'Patrick Star',
          fontFamily: 'Calibri',
          fontSize: 18,
          padding: 5,
          fill: 'white',
        })
      );

      groupPat.add(patrickText)

        // Patrick Jellyfish

let groupJellyfish = new Konva.Group();
pat.add(groupJellyfish)

let patJellyfishObj = new Image();
patJellyfishObj.onload = function () {

        for (let i = 0; i < episode.Patrick.jellyfish; i++) {

          let patJellyfish = new Konva.Image({
               x: 1300 + i*(-65),
               y: 5,
               image: patJellyfishObj,
          });
          groupJellyfish.add(patJellyfish);
     }
};

patJellyfishObj.src = 'jellyfish.png';


</script>
</body>
</html>